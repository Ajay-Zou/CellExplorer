<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><title>Data structure and format - Cell Explorer</title><link rel="shortcut icon" href="http://localhost:4000/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="http://localhost:4000/assets/css/just-the-docs.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=155839433"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', "155839433"); </script> <script type="text/javascript" src="http://localhost:4000/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="http://localhost:4000/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Data structure and format | Cell Explorer</title><meta name="generator" content="Jekyll v3.8.6" /><meta property="og:title" content="Data structure and format" /><meta property="og:locale" content="en_US" /><meta name="description" content="Matlab GUI and standardized pipeline for exploring and classifying spike sorted single units acquired using extracellular electrodes." /><meta property="og:description" content="Matlab GUI and standardized pipeline for exploring and classifying spike sorted single units acquired using extracellular electrodes." /><link rel="canonical" href="http://localhost:4000/pipeline/data-structure-and-format/" /><meta property="og:url" content="http://localhost:4000/pipeline/data-structure-and-format/" /><meta property="og:site_name" content="Cell Explorer" /> <script type="application/ld+json"> {"description":"Matlab GUI and standardized pipeline for exploring and classifying spike sorted single units acquired using extracellular electrodes.","@type":"WebPage","headline":"Data structure and format","url":"http://localhost:4000/pipeline/data-structure-and-format/","@context":"https://schema.org"}</script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"><title>Link</title><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg><div class="page-wrap"><div class="side-bar"><div class="site-header"> <a href="http://localhost:4000" class="site-title lh-tight"> Cell Explorer </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button></div><div class="navigation main-nav js-main-nav"><nav role="navigation" aria-label="Main navigation"><ul class="navigation-list"><li class="navigation-list-item"><a href="http://localhost:4000/" class="navigation-list-link">Home</a><li class="navigation-list-item active"><a href="http://localhost:4000/pipeline/running-pipeline/" class="navigation-list-link">Running pipeline</a><ul class="navigation-list-child-list "><li class="navigation-list-item active"><a href="http://localhost:4000/pipeline/data-structure-and-format/" class="navigation-list-link active">Data structure and format</a><li class="navigation-list-item "><a href="http://localhost:4000/pipeline/standard-cell-metrics/" class="navigation-list-link">Standard cell metrics</a><li class="navigation-list-item "><a href="http://localhost:4000/pipeline/custom-calculations/" class="navigation-list-link">Custom calculations</a><li class="navigation-list-item "><a href="http://localhost:4000/pipeline/your-own-metrics/" class="navigation-list-link">Adding your own metrics</a></ul><li class="navigation-list-item"><a href="http://localhost:4000/interface/interface/" class="navigation-list-link">Graphical interface</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/interface/capabiliities/" class="navigation-list-link">Capabilities</a><li class="navigation-list-item "><a href="http://localhost:4000/interface/single-cell-plot-options/" class="navigation-list-link">Single cell plot options</a><li class="navigation-list-item "><a href="http://localhost:4000/interface/preferences/" class="navigation-list-link">Preferences</a><li class="navigation-list-item "><a href="http://localhost:4000/interface/keyboard-shortcuts/" class="navigation-list-link">Keyboard shortcuts</a><li class="navigation-list-item "><a href="http://localhost:4000/interface/spike-and-event-data/" class="navigation-list-link">Spike and event data</a><li class="navigation-list-item "><a href="http://localhost:4000/interface/ground-truth-data/" class="navigation-list-link">Ground truth data</a><li class="navigation-list-item "><a href="http://localhost:4000/interface/custom-single-cell-plots/" class="navigation-list-link">Custom single cell plots</a></ul><li class="navigation-list-item"><a href="http://localhost:4000/database/preparation/" class="navigation-list-link">Database</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="http://localhost:4000/database/loading-sessions/" class="navigation-list-link">Loading sessions from the database</a><li class="navigation-list-item "><a href="http://localhost:4000/database/public-data/" class="navigation-list-link">Use public data as reference</a></ul></ul></nav></div><footer class="site-footer"><p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p></footer></div><div class="main-content-wrap js-main-content" tabindex="0"><div class="main-content"><div class="page-header js-page-header"><div class="search"><div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Cell Explorer" aria-label="Search Cell Explorer" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg></div><div class="js-search-results search-results-wrap"></div></div><ul class="list-style-none text-small aux-nav"><li class="d-inline-block my-0"><a href="//github.com/petersenpeter/Cell-Explorer">Cell Explorer on GitHub</a></ul></div><div class="page"><nav class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/pipeline/running-pipeline/">Running pipeline</a><li class="breadcrumb-nav-list-item"><span>Data structure and format</span></ol></nav><div id="main-content" class="page-content" role="main"><h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Table of contents</h2><ol id="markdown-toc"><li><a href="#data-paths" id="markdown-toc-data-paths">Data paths</a><li><a href="#data-structures" id="markdown-toc-data-structures">Data structures</a><ol><li><a href="#cell-metrics" id="markdown-toc-cell-metrics">Cell metrics</a><li><a href="#session-metadata" id="markdown-toc-session-metadata">Session metadata</a><li><a href="#spikes" id="markdown-toc-spikes">Spikes</a><li><a href="#firing-rate-maps" id="markdown-toc-firing-rate-maps">Firing rate maps</a><li><a href="#events" id="markdown-toc-events">Events</a><li><a href="#manipulations" id="markdown-toc-manipulations">Manipulations</a><li><a href="#channels" id="markdown-toc-channels">Channels</a><li><a href="#time-series" id="markdown-toc-time-series">Time series</a></ol></ol><h2 id="data-paths"> <a href="#data-paths" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Data paths</h2><p>For each session there are two main paths that the Cell Explorer uses, a basepath and a clusteringpath (relative to basepath).</p><p>The basepath contains the raw data and session level files. The data in the basepath should follow this naming convention: sessionName.*, e.g. sessionName.dat and sessionName.lfp (lowpass filtered and downsampled. The lfp file is automatically generated in the pipeline if necessary). The metadata is stored in a sessionName.session.mat file located in the basepath.</p><p>The clusteringpath contains the spike data, including cell metrics. The cell metrics are all stored in a cell_metrics struct/file.</p><h2 id="data-structures"> <a href="#data-structures" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Data structures</h2><h3 id="cell-metrics"> <a href="#cell-metrics" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Cell metrics</h3><p>The cell metrics are kept in a <a href="https://github.com/petersenpeter/Cell-Explorer/wiki/Cell-metrics">cell_metrics struct as described here</a>. The cell metrics are stored in: sessionName.cell_metrics.cellinfo.mat in the clustering path.</p><h3 id="session-metadata"> <a href="#session-metadata" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Session metadata</h3><p>A Matlab struct (session), stored in a .mat file: sessionName.session.mat. The session struct contains all session-level metadata. The session struct can be generated using the <a href="https://github.com/petersenpeter/Cell-Explorer/blob/master/calc_CellMetrics/sessionTemplate.m">sessionTemplate.m</a> and visualized with <a href="https://github.com/petersenpeter/Cell-Explorer/blob/master/calc_CellMetrics/gui_session.m">gui_session.m</a>. It is structured by data types as defined below:</p><ul><li>general<ul><li>name : name of session<li>investigator : investigator of the session<li>projects : projects the session belong to<li>date : date the session was recorded<li>time : start time of the session<li>location : location where the session took place<li>experimenters : who performed the experiments<li>duration : the total duration of the session (seconds)<li>sessionType : type of session (chronic/acute)<li>notes : any notes</ul><li>animal<ul><li>name : name of animal<li>sex : sex of animal<li>species : species of animal<li>strain : strain of animal<li>geneticLine : genetic line of animal</ul><li>epochs<ul><li>name<li>behavioralParadigm<li>builtMaze<li>mazeType<li>manipulations<li>startTime<li>stopTime</ul><li>extracellular<ul><li>equipment : hardware used to acquire the data<li>fileFormat : format of the raw data<li>sr : sample rate<li>nChannels : number of channels<li>nSamples : number of samples<li>nElectrodeGroups : number of electrode groups<li>electrodeGroups (struct) : struct with definition of electrode groups (1-indexed)<li>nSpikeGroups : number of spike groups<li>spikeGroups (struct) : struct with definition of spike groups (1-indexed)<li>precision : e.g. signed int16.<li>leastSignificantBit : range/precision in µV. Intan system: 0.195µV/bit<li>srLFP : sample rate of the LFP file<li>electrode : struct with implanted electrodes<ul><li>siliconProbes : name of the probe<li>company : company producing the probe<li>nChannels : number of channels<li>nShanks : number of shanks<li>AP_coordinates : Anterior-Posterior coordinates(mm)<li>ML_coordinates : Medial-Lateral coordinates (mm)<li>depth : implant depth (mm)<li>brainRegions : implant brain region acronym (Allen institute Atlas)</ul></ul><li>brainRegions<ul><li>regionAcronym : e.g. CA1 or HIP, Allen institute Atlas<ul><li>brainRegion<li>channels : list of channels<li>electrodeGroups : list of electrode groups</ul></ul><li>channelTags<ul><li>tagName (e.g. Theta, Cortical, Ripple, Bad)<ul><li>channels : list of channels (1-indexed)<li>electrodeGroups : list of electrode groups (1-indexed)</ul></ul><li>behavioralTracking<ul><li>equipment : hardware used to acquire the data<li>filenames : file names containing the tracking<li>framerate : frame rate of the tracking<li>notes</ul><li>inputs<ul><li>inputTag : unique name, e.g. temperature, stimPulses,OptitrackTTL<ul><li>equipment : hardware used to acquire the data<li>inputType : adc, aux, dat, dig …<li>channels : list of channels (1-indexed)<li>description</ul></ul><li>analysisTags<ul><li>tagName: the numeric or string values saved in the tag</ul><li>spikeSorting<ul><li>method : e.g. Kilosort<li>format : Phy, KiloSort, KlustaViewer, Klustakwik, …<li>relativePath : relative to base/sessionpath<li>channels : list of channels selected.<li>spikeSorter : Person performed the manual spike sorting<li>notes<li>cellMetrics : (boolean) if the cell metrics has been run<li>manuallyCurated : (boolean) if manual curation has been performed</ul><li>timeseries<ul><li>typeTag : unique type (adc, aux, dat, dig …)<ul><li>fileName : file name<li>precision : e.g. int16<li>nChannels : number of channels<li>sr : sample rate<li>nSamples : number of samples<li>leastSignificantBit : range/precision in µV. Intan system: 0.195µV/bit<li>equipment : hardware used to acquire the data</ul></ul></ul><p>The sessionName.session.mat files should be stored in the basepath.</p><h3 id="spikes"> <a href="#spikes" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Spikes</h3><p>A Matlab struct (spikes), stored in a .mat file: sessionName.spikes.cellinfo.mat. It can be generated with <a href="https://github.com/petersenpeter/Cell-Explorer/blob/master/calc_CellMetrics/loadSpikes.m">loadSpikes.m</a>. The Cell Inspector’s pipeline (calc_CellMetrics.m) used the script loadSpikes.m, to automatically load spike-data from either Kilosort/Phy or Neurosuite and saves it to a spikes struct. The struct has the following fields:</p><ul><li>ts: a 1xN cell-struct for N units each containing a 1xM vector with M spike events in samples.<li>times: a 1xN cell-struct for N units each containing a 1xM vector with M spike events in seconds.<li>cluID: a 1xN vector with inherited IDs from the applied clustering algorithm.<li>UID: a 1xN vector with values 1:N.<li>shankID: a 1xN vector containing the corresponding shank/spikegroup each unit (1-indexed).<li>maxWaveformCh: a 1xN vector with the channel for the maximum waveform for the units (0-indexed)<li>maxWaveformCh1: a 1xN vector with the channel for the maximum waveform for the units (1-indexed)<li>total: a 1xN vector with the total number of spikes for each unit.<li>peakVoltage: a 1xN vector with spike waveform amplitude (µV).<li>filtWaveform: a 1xN cell-struct with spike waveforms from maxWaveformChannel (µV).<li>filtWaveform_std: a 1xN cell-struct with the std of the spike waveforms (µV).<li>rawWaveform: a 1xN cell-struct with raw spike waveforms (µV).<li>rawWaveform_std: a 1xN cell-struct with std of the raw spike waveforms (µV).<li>timeWaveform: a 1xN cell-struct with spike timestamps for the waveforms (ms).<li>numcells: number of cells.<li>sessionName: name of the session (string).<li>spindices: a Kx2 matrix where the first column contains the K spike times for all units and the second column contains the unit index for each spike.<li>processinginfo: a substruct with information about how the spikes was generated including the name of the function, version, date and the parameters.</ul><p>Any extra field can be added with info about the units, e.g. the theta phase of each spike for the units, or the position/speed of the animal for each spike. sessionName.spikes.cellinfo.mat should be located in the clusteringpath.</p><h3 id="firing-rate-maps"> <a href="#firing-rate-maps" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Firing rate maps</h3><p>A Matlab struct (ratemap) containing firing rat maps, stored in a .mat file: sessionName.ratemap.firingRateMap.mat with the following fields:</p><ul><li>map: a 1xN cell-struct for N units each containing a KxL matrix, where K corresponds to the bin count and L to the number of states. States can be trials, manipulatio states, left-right states…<li>x_bins: a 1xK vector with K bin values used to generate the firing rate map.<li>state_labels: a 1xL vector with char labels describing the states.</ul><p>The processed spike data should be stored in the clusteringpath.</p><h3 id="events"> <a href="#events" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Events</h3><p>A Matlab struct (eventName), stored in a .mat file: sessionName.eventName.events.mat with the following fields:</p><ul><li>timestamps: Px2 matrix with intervals for the P events in seconds.<li>peaks: Event time for the peak of each events in seconds (Px1).<li>amplitude: amplitude of each event (Px1).<li>amplitudeUnits: specify the units of the amplitude vector.<li>eventID: numeric ID for classifying various event types (Px1).<li>eventIDlabels: cell array with labels for classifying various event types defined in stimID (cell array, Px1).<li>eventIDbinary: boolean specifying if eventID should be read as binary values (default: false).<li>center: center time-point of event (in seconds; calculated from timestamps; Px1).<li>duration: duration of event (in seconds; calculated from timestamps; Px1).<li>detectorinfo: info about how the events were detected.</ul><p>The *.events.mat files should be stored in the basepath.</p><h3 id="manipulations"> <a href="#manipulations" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Manipulations</h3><p>A Matlab struct (manipulationName), stored in a .mat file: sessionName.eventName.manipulation.mat with the following fields:</p><ul><li>timestamps: Px2 matrix with intervals for the P events in seconds.<li>peaks: Event time for the peak of each events in seconds (Px1).<li>amplitude: amplitude of each event (Px1).<li>amplitudeUnits: specify the units of the amplitude vector.<li>eventID: numeric ID for classifying various event types (Px1).<li>eventIDlabels: cell array with labels for classifying various event types defined in stimID (cell array, Px1).<li>eventIDbinary: boolean specifying if eventID should be read as binary values (default: false).<li>center: center time-point of event (in seconds; calculated from timestamps; Px1).<li>duration: duration of event (in seconds; calculated from timestamps; Px1).<li>detectorinfo: info about how the events were detected.</ul><p>The *.manipulation.mat files should be stored in the basepath.</p><h3 id="channels"> <a href="#channels" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Channels</h3><p>A matlab struct (ChannelName), stored in a .mat file: sessionName.ChannelName.channelinfo.mat with the following fields:</p><ul><li>channel: a 1xQ vector containing a list of Q channel indexes (0-indexed)<li>channelClass: a 1xQ cell with classification assigned to each channel (char)<li>processinginfo: a struct with information about how mat file was generated including the name of the function, version, date and the parameters.<li>detectorinfo: If the channelinfo struct is based on determined events, detectorinfo contains info about how the event was processed.</ul><p>The *.channelinfo.mat files should be stored in the basepath.</p><h3 id="time-series"> <a href="#time-series" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Time series</h3><p>A Matlab struct (timeserieName), stored in a .mat file: sessionName.timeserieName.timeseries.mat with the following fields:</p><ul><li>channel: a 1xQ vector containing a list of Q channel indexes (0-indexed)<li>timestamps: a 1xQ cell with classification assigned to each channel (char)<li>processinginfo: a struct with information about how mat file was generated including the name of the function, version, date and the parameters.</ul><p>Any other field can be added to the struct containing time series data. The *.timeseries.mat files should be stored in the basepath.</p><hr><footer role="contentinfo"><p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2019-2020 Peter Petersen</p></footer></div></div></div></div>
